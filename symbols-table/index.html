<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>URI-замена символов</title>
  <!-- Подключение Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">
  <div class="container">
  </div>
  <div class="container my-5">
    <h1 class="mb-4">Замена специальных символов (URI формат)</h1>
    <div class="row">      
        <div class="col-5">
          <input type="text" class="form-control mb-2" id="source_value">
        </div>
        <div class="col-2">
          <input type="button" class=" btn btn-primary form-control mb-2" id="input-symbols3" value="convert->" onclick="convert()">
        </div>
        <div class="col-5">
          <input type="text" class="form-control mb-2" id="target_value" disabled>
        </div>
    </div>
    <table class="table table-striped table-bordered">
      <thead class="table-dark">
        <tr>
          <th scope="col">Исходный символ</th>
          <th scope="col">Описание</th>
          <th scope="col">URI-замена</th>
        </tr>
      </thead>
      <tbody id="symbols-table-body">
        <!-- Строки будут добавлены JS -->
      </tbody>
    </table>
  </div>

  <script>
    // Список символов (вы можете добавлять новые)
    const symbols = [
      // '@',
      // '#',
      // '$',
      // '%',
      // '&',
      // ' ',
      // '?',
      // '/',
      // ',',
      ["%", "%", "Процент"],
      [" ", "' '", "Пробел"],
      ["\t", "\\t", "Табуляция"],
      ["\n", "\\n", "Переход строки"],
      ["\r", "\\r", "Возврат каретки"],
      ["!", "!", "Восклицательный знак"],
      ["\"", "\"", "Двойная кавычка"],
      ["#", "#", "Октоторп, решетка"],
      ["\\$", "$", "Знак доллара"],
      ["&", "&", "Амперсанд"],
      ["'", "'", "Одиночная кавычка"],
      ["(", "(", "Открывающаяся скобка"],
      [")", ")", "Закрывающаяся скобка"],
      ["*", "*", "Звездочка"],
      ["+", "+", "Знак плюс"],
      [",", ",", "Запятая"],
      ["-", "-", "Дефис"],
      ["\\.", ".", "Точка"],
      ["/", "/", "Слеш, косая черта"],
      [":", ":", "Двоеточие"],
      [";", ";", "Точка с запятой"],
      ["<", "<", "Открывающаяся угловая скобка"],
      ["=", "=", "Знак равно"],
      [">", ">", "Закрывающаяся угловая скобка"],
      ["?", "?", "Вопросительный знак"],
      ["@", "@", "At sign, по цене, собачка"],
      ["[", "[", "Открывающаяся квадратная скобка"],
      ["\\", "\\", "Одиночный обратный слеш '\\'"],
      ["]", "]", "Закрывающаяся квадратная скобка"],
      ["^", "^", "Циркумфлекс"],
      ["_", "_", "Нижнее подчеркивание"],
      ["`", "`", "Гравис, Апостроф"],
      ["{", "{", "Открывающаяся фигурная скобка"],
      ["|", "|", "Вертикальная черта"],
      ["}", "}", "Закрывающаяся фигурная скобка"],
      ["~", "~", "Тильда"],
    ];
    let special_chars = ['\t','\n','\r']

    let symbols_source = symbols.map(x=>x[0])
    //console.log(symbols_source)
    const tbody = document.getElementById('symbols-table-body');
    function strictURICode(char) {
      return '%' + char.charCodeAt(0).toString(16).toUpperCase();
    }
    symbols.forEach(symbol => {
      let char = symbol[0];
      let en = symbol[1];
      let text = symbol[2];
      const encoded = strictURICode(char);
      const row = document.createElement('tr');
      const tdSymbol = document.createElement('td');
      tdSymbol.textContent = en;
      row.appendChild(tdSymbol);

      const tdText = document.createElement('td');
      tdText.textContent = text;
      row.appendChild(tdText);

      const tdEncoded = document.createElement('td');
      tdEncoded.textContent = encoded;
      row.appendChild(tdEncoded);


      tbody.appendChild(row);
    });

    function convert_str(source_value) {
      result_value = ''
        // let index = 0;
        // let n = source_value.lenght;
        
        // while (index < n){
        //   element = source_value[index]
        //   if(element == '\\') {
        //     index++;
        //     element+= source_value[index]
        //   }
        //   if(symbols_source.indexOf(element) != -1){
        //     result_value += strictURICode(element)
        //   }else{
        //     result_value += element
        //   }
        //   index++;
        // } 

        //console.log(source_value)
        source_value.split('').forEach(element => {
          if(symbols_source.indexOf(element) != -1){
            result_value += strictURICode(element)
          }else{
            result_value += element
          }
        });
      return result_value;
    }

    function convert(){
      
      let source_value = document.getElementById("source_value").value;
      if (source_value != ""){
        //console.log(source_value)
        result_value = convert_str(source_value)        
        //let target_value = document.getElementById("target_value").value;
        document.getElementById("target_value").value = result_value
        //strictURICode(char)
      }
    }

    // Пример динамического добавления
    // Вы можете добавить ещё символ:
    // function addSymbol(newSymbol) {
    //   const encoded = encodeURIComponent(newSymbol);
    //   const row = document.createElement('tr');
    //   row.innerHTML = `<td>${newSymbol}</td><td>${encoded}</td>`;
    //   tbody.appendChild(row);
    // }
    // addSymbol('*'); // пример добавления
  </script>
</body>

</html>